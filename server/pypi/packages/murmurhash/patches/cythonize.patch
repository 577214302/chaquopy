--- src-original/setup.py	2017-06-01 07:25:11.000000000 +0000
+++ src/setup.py	2022-09-25 21:06:47.012175663 +0000
@@ -7,6 +7,7 @@
 from distutils.command.build_ext import build_ext
 from distutils.sysconfig import get_python_inc
 from distutils import ccompiler, msvccompiler
+from Cython.Build import cythonize  # Chaquopy: added
 
 try:
     from setuptools import Extension, setup
@@ -106,7 +107,7 @@
 
         ext_modules = []
         for mod_name in MOD_NAMES:
-            mod_path = mod_name.replace('.', '/') + '.cpp'
+            mod_path = mod_name.replace('.', '/') + '.pyx'  # Chaquopy: was '.cpp'
             ext_modules.append(
                 Extension(mod_name, [mod_path,
                                      'murmurhash/MurmurHash2.cpp',
@@ -128,7 +129,9 @@
             version=about['__version__'],
             url=about['__uri__'],
             license=about['__license__'],
-            ext_modules=ext_modules,
+            # Chaquopy: added `cythonize` because the pre-generated .cpp file in 0.28.0
+            # isn't compatible with Python 3.11.
+            ext_modules=cythonize(ext_modules, language_level=2),
             classifiers=[
                 'Development Status :: 4 - Beta',
                 'Environment :: Console',
